
# Паттерн Фабричный Метод на C#

Этот проект демонстрирует реализацию паттерна проектирования "Фабричный Метод" на языке C# с использованием рефлексии для динамического создания объектов.

## Описание

**Фабричный метод** — это порождающий паттерн, который предоставляет интерфейс для создания объектов в суперклассе, но позволяет подклассам изменять тип создаваемого объекта. В данном проекте реализована возможность создания документов различных типов (например, Word и Excel) через фабрики, которые инкапсулируют логику создания объектов.

Использование рефлексии позволяет динамически определять и создавать нужные фабрики, что облегчает добавление новых типов документов без изменения основной логики программы.

## Структура проекта

- **Document**: Содержит классы, представляющие конкретные типы документов (например, `ExcelFile`, `WordFile`), которые реализуют интерфейс `IDocument`.
- **Factories**: Содержит классы фабрик для каждого типа документа (например, `ExcelFileFactory`, `WordFileFactory`), наследующие абстрактный класс `DocumentFactory`.
- **Interfaces**: Содержит интерфейс `IDocument`, который определяет общие методы для всех документов (например, `Open`, `Edit`, `Save`).
- **DocumentFactory.cs**: Абстрактный класс фабрики, определяющий метод `CreateDocument`, который должен быть реализован в конкретных фабриках.
- **Program.cs**: Основная логика программы, где создаются фабрики документов динамически на основе входных данных, используя рефлексию.

## Какие задачи решает паттерн

- **Инкапсуляция логики создания объектов**: Фабричный метод позволяет скрыть детали создания объектов, предоставляя унифицированный интерфейс для их создания.
- **Расширяемость**: Легко добавлять новые типы документов и фабрики для них без изменений в основной программе. 
- **Упрощение поддержки**: Код программы не зависит от конкретных типов документов, что упрощает его поддержку и тестирование.

## Динамическое создание фабрик с помощью рефлексии

В методе `GetDocumentFactory` в `Program.cs` используется рефлексия для поиска и создания соответствующей фабрики на основе введенного типа документа. Это исключает необходимость писать множество условных операторов и позволяет легко добавлять новые типы документов.

Пример метода:
```csharp
static DocumentFactory GetDocumentFactory(string docType)
{
    string factoryClassName = $"FactoryMethod.Factories.{docType}FileFactory";
    Assembly assembly = Assembly.GetExecutingAssembly();
    Type factoryType = assembly.GetType(factoryClassName);

    if (factoryType == null)
    {
        throw new NotSupportedException($"Фабрика для типа документа '{docType}' не найдена.");
    }

    return (DocumentFactory)Activator.CreateInstance(factoryType);
}
```

## Использование

1. Склонируйте репозиторий и откройте проект в Visual Studio или другом редакторе C#.
2. Запустите файл `Program.cs`.
3. Программа предложит ввести тип документа (например, "Word" или "Excel"). На основе ввода будет создан и открыт соответствующий тип документа.

## Добавление нового типа документа

Чтобы добавить новый тип документа:

1. Создайте новый класс в папке **Document**, реализующий интерфейс `IDocument`.
2. Создайте соответствующий класс фабрики в папке **Factories**, наследующий `DocumentFactory` и реализующий метод `CreateDocument`.
3. Новый тип документа будет автоматически доступен для создания без изменений в существующем коде.

## Лицензия

Этот проект распространяется по лицензии MIT.
